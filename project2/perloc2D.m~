function [SE Mlab] = perloc2D(L,p)

% Area
A = L*L;

% Setting up M
M = rand(L);
M( M(:)<(1-p) ) = 0;
M( M(:)>=(1-p) ) = 1;
M_temp = M;

% Using labeling function
Mlab = bwlabel(M_temp,4);
cM = zeros(L);

SE = zeros(1, max(max(Mlab)));
for i = 1:max(max(Mlab))
    SE(i) = length(Mlab(Mlab(:) == i))
end

SE = sum( SE.^2./A );

f1 = figure(1);
imagesc(M_temp);


end