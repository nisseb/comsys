
Lvals = [20 50 100 200 300];
pvals = 0:0.01:1;
sE = zeros(length(Lvals),length(pvals));

i = 1;
j = 1;

f1 = figure(1);

for L=Lvals
    
    for p=pvals
        sE(j,i) = perloc2D(L,p);
        i = i + 1;
    end
    
    plot(pvals,sE(j,:)./(L*L), 'Linewidth', 1, 'Marker', '*', ...
        'DisplayName', ['L=' num2str(L)]);
    
    legend('-DynamicLegend');
    xlabel('probability p', 'FontSize', 20)
    ylabel('Expected cluster size', 'FontSize', 20)
    hold on
    
    j = j + 1;
end